# 栈

###### 参考网站：https://github.com/DigBullTech-Michael/ctf_re/blob/master/tutorials/171213_7th.md

栈是计算机科学里最重要的且最基础的`数据结构`之一。

从技术上讲，栈就是CPU寄存器里面的某个指针所指向的一片内存区域。这里所说的`某个指针`通常位于x86/x64平台的`ESP寄存器/RSP寄存器`，以及ARM平台的`SP寄存器`。

操作站最常见的指令是`PUSH`和`POP`，在 x86 和 ARM Thumb 模式的指令集里都有这两条指令。

`PUSH指令`会对ESP/RSP/SP寄存器的值进行`减法运算`，使之`减去4(32位）或8(64位`）（注意：写汇编代码时，可以push一个16位的数据，这样栈顶会减去2，但是由于编译器会做32位对齐，所以我们看到的基本上都是加减4或8的情况。），然后将操作数写到上述寄存器里的指针所指向的内存中。

`POP指令`是PUSH的逆操作：他先从栈指针（Stack Pionter,上面三个寄存器之一）指向的内存中读取数据，用以备用（通常是写到其他寄存器里面），然后再将栈指针的数值`加上4或8`.
在分配栈的空间之后，栈指针，即Stack Pointer所指向的地址是栈的底部。PUSH将减少栈指针的数值，而POP会增加它的数值。栈的“底”实际上使用的是整个栈的最低地址，即是整个栈的启始内存地址。

ARM的栈分为递增栈和递减栈。递减栈（descending stack)的首地址是栈的最高地址，栈向低地址增长，栈指针的值随栈的增长而减少，如STMFA/LMDFA、STMFD/LDMFD、STMED、LDMEA等指令，都是递增栈的操作指令。
